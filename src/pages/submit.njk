---
layout: layouts/base.njk
title: Submit Your Demo
description: Share your design style implementation with the community. All submissions are reviewed by instructors before publishing.
permalink: /submit/
---

{% import "macros/form-field.njk" as field %}

<div class="max-w-container-md mx-auto px-6 section-padding">
  <div class="text-center mb-12">
    <h1 class="text-h1 mb-4">Submit Your Demo</h1>
    <p class="text-neutral-500">
      Share your design style implementation with the community.
      All submissions are reviewed by instructors before publishing.
    </p>
  </div>

  {# Success Message (hidden by default) #}
  <div id="success-message" class="hidden bg-green-50 border-l-4 border-green-500 p-8 text-center mb-8">
    <span class="text-4xl block mb-4">âœ“</span>
    <h2 class="text-2xl font-bold text-green-700 mb-2">Submission Received!</h2>
    <p class="text-green-600 mb-6">
      Your demo has been submitted for review. You'll receive an email
      when it's approved.
    </p>
    <a href="{{ '/' | url }}" class="btn btn-primary bg-green-600 hover:bg-green-700 inline-block">
      Back to Gallery
    </a>
  </div>

  {# Submission Form #}
  <form
    id="submission-form"
    class="space-y-6"
    method="POST"
    action="/.netlify/functions/submit-form"
    netlify
    data-netlify="true"
    netlify-honeypot="bot-field"
    name="demo-submission"
    novalidate
  >
    {# Honeypot for spam prevention #}
    <p class="hidden">
      <label>Don't fill this out if you're human: <input name="bot-field" /></label>
    </p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      {{ field.input('name', 'Full Name', 'text', 'Your name', true) }}
      {{ field.input('email', 'Email', 'email', 'you@email.com', true) }}
    </div>

    {# Design styles populated from Sanity CMS #}
    {% set styleOptions = [] %}
    {% for style in designStyles.styles %}
      {% set styleOptions = (styleOptions.push({ value: style.slug.current or style.slug, label: style.title }), styleOptions) %}
    {% endfor %}
    {{ field.select('style', 'Design Style', styleOptions, true, 'Select the design style your demo represents') }}

    {{ field.input('demoUrl', 'Demo URL', 'url', 'https://yourusername.github.io/demo', true, 'Must be a publicly accessible URL (GitHub Pages, Netlify, etc.)') }}

    {# Screenshot Upload #}
    <div class="form-group">
      <label for="screenshot" class="form-label">
        Screenshot <span class="text-swiss-red">*</span>
      </label>
      <div class="border-2 border-dashed border-black p-8 text-center cursor-pointer hover:bg-neutral-50 transition-colors">
        <input
          type="file"
          id="screenshot"
          name="screenshot"
          accept="image/png,image/jpeg,image/webp"
          required
          aria-required="true"
          aria-describedby="screenshot-helper screenshot-error"
          aria-invalid="false"
          class="hidden"
        />
        <label for="screenshot" class="cursor-pointer">
          <span class="text-4xl block mb-2">ðŸ“·</span>
          <p id="screenshot-helper" class="text-sm text-neutral-500">Click to upload or drag and drop</p>
          <p class="text-caption text-neutral-400 mt-1">PNG, JPG, WebP up to 5MB</p>
        </label>
        <p id="file-name" class="text-sm text-neutral-600 mt-2 hidden"></p>
      </div>
      <p id="screenshot-error" class="form-error hidden" role="alert"></p>
    </div>

    {{ field.textarea('authenticity', 'Authenticity Explanation', 5, 'Explain how your demo authentically represents the design style. Reference specific typography, color, layout, and compositional choices...', true, 'Minimum 50 characters required') }}

    <div class="space-y-4 pt-6 border-t border-neutral-200">
      <p class="text-sm font-medium text-neutral-700">Consent & Preferences</p>

      {{ field.checkbox('consent', 'I consent to my name and submission being displayed publicly on MyWebClass.org if approved. <a href="' + ('/legal/privacy/' | url) + '" class="underline">Privacy Policy</a>', true) }}

      <div class="pl-0 text-xs text-neutral-500 -mt-2 mb-4">
        <span class="text-swiss-red">*</span> Required to submit
      </div>

      {{ field.checkbox('marketing', 'I\'d like to receive updates, tips, and news about MyWebClass.org (optional)', false) }}

      <p class="text-xs text-neutral-400 pl-0 -mt-2">
        You can unsubscribe at any time. We never share your email.
      </p>
    </div>

    <button
      type="submit"
      class="btn btn-primary w-full"
    >
      Submit for Review
    </button>
  </form>
</div>

<script src="{{ '/scripts/submission-form.js' | url }}" defer></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // File upload preview
    const fileInput = document.getElementById('screenshot');
    const fileName = document.getElementById('file-name');

    if (fileInput && fileName) {
      fileInput.addEventListener('change', function() {
        if (this.files && this.files[0]) {
          fileName.textContent = 'Selected: ' + this.files[0].name;
          fileName.classList.remove('hidden');
        }
      });
    }

    // Form submission handler with validation and Netlify function
    const form = document.getElementById('submission-form');
    const successMessage = document.getElementById('success-message');

    if (form && successMessage) {
      form.addEventListener('submit', async function(e) {
        e.preventDefault();

        // Validate form using the external validation script
        const firstInvalidField = window.validateSubmissionForm ? window.validateSubmissionForm() : null;

        if (firstInvalidField) {
          // Focus the first invalid field
          const invalidInput = document.getElementById(firstInvalidField);
          if (invalidInput) {
            invalidInput.focus();
          }
          return;
        }

        // Gather form data
        const formData = new FormData(form);
        const data = {};
        formData.forEach((value, key) => {
          // Skip file data for JSON submission (file handled separately or as base64)
          if (key !== 'screenshot') {
            data[key] = value;
          }
        });

        // Convert checkbox values to booleans
        // Checkboxes in FormData have value "on" when checked, absent when unchecked
        data.consent = formData.has('consent');
        data.marketing = formData.has('marketing');

        // Disable submit button while processing
        const submitButton = form.querySelector('button[type="submit"]');
        if (submitButton) {
          submitButton.disabled = true;
          submitButton.textContent = 'Submitting...';
        }

        try {
          const response = await fetch('/.netlify/functions/submit-form', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
          });

          if (response.ok) {
            form.classList.add('hidden');
            successMessage.classList.remove('hidden');
            successMessage.scrollIntoView({ behavior: 'smooth' });
          } else {
            const errorData = await response.json().catch(() => ({}));
            throw new Error(errorData.message || 'Submission failed');
          }
        } catch (error) {
          console.error('Form submission error:', error);
          alert('Something went wrong. Please try again.');

          // Re-enable submit button
          if (submitButton) {
            submitButton.disabled = false;
            submitButton.textContent = 'Submit for Review';
          }
        }
      });
    }
  });
</script>
